% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utils_redcap_data_pulls.R
\name{fetch_new_redcap_data}
\alias{fetch_new_redcap_data}
\title{Fetch New RedCap Data}
\usage{
fetch_new_redcap_data(
  token,
  url,
  data,
  timestamp_column,
  wrangle_function,
  api_function,
  ...
)
}
\arguments{
\item{token}{A string. The API token for accessing the RedCap project.}

\item{url}{A string. The API URL for the RedCap project.}

\item{data}{A data frame. The existing dataset loaded in the app, containing previous records.}

\item{timestamp_column}{A string. The name of the timestamp column in the dataset used to filter new records.}

\item{wrangle_function}{A function. The function to process the combined data.}

\item{api_function}{A function. The API function to call (e.g., `redcap_api_call`, `forms_api_pull`).}

\item{...}{Additional arguments to be passed to the API function.}
}
\value{
A data frame containing the combined and wrangled dataset.
This dataset includes new records (if available) along with the previous data.
}
\description{
Pulls and wrangles new data from RedCap based on a timestamp column.
This function retrieves new data from the RedCap API for records that have
a timestamp greater than or equal to the most recent timestamp in the existing dataset.
It then combines the new data with the existing data, applies a wrangling
function to the combined dataset, and removes duplicate records.
}
\details{
The function retrieves the most recent date in the `timestamp_column` of the
existing dataset and uses it to filter records in RedCap using a `filterLogic` parameter.
Records with timestamps greater than or equal to the most recent date are pulled from
RedCap and combined with the existing dataset.

**Key Features:**
1. Ensures that **wrangling occurs even if no new data** is returned from the API.
2. **Combines and wrangles** the old and new data together.
3. **Removes duplicate records** using `dplyr::distinct()`.
}
\note{
- The `timestamp_column` must exist in the **data** parameter; otherwise, the function will stop with an error.
- If the **wrangle_function** encounters an error, the function will print debug information and stop execution.
- The **dplyr::distinct()** function is applied to the final dataset to ensure there are no duplicate rows.
}
\seealso{
- [redcap_api_call()]: Used to call the RedCap API.
- [dplyr::distinct()]: Used to remove duplicate rows from the combined dataset.
}
